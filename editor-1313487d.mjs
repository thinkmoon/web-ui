var L=Object.defineProperty,S=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var B=(e,t,l)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,d=(e,t)=>{for(var l in t||(t={}))I.call(t,l)&&B(e,l,t[l]);if(k)for(var l of k(t))P.call(t,l)&&B(e,l,t[l]);return e},$=(e,t)=>S(e,w(t));import{_ as Y,d as A,P as C,T as j,C as q,a as N,b as H,u as M,r as c,o,c as r,e as s,f as i,F as p,g as m,w as n,h as O,t as g,i as T,j as U}from"./entry-31b90db0.mjs";const h=[{name:"thumb",value:""},{name:"desc",value:""}],z=A({data(){return{article:{title:"",text:"",category_id:"",tag:[],selectedTag:[],fields:[]},categoryList:[],tagList:[]}},activated(){this.$route.query.cid?C.getDetail({cid:this.$route.query.cid}).then(e=>{this.article=d(d({},this.article),e),this.article.selectedTag=this.article.tag.map(t=>t.tid),this.article.fields.length||(this.article.fields=h)}):(this.data={},this.article.fields=h),this.getCategory(),this.getTag()},methods:{getTag(){j.getTag().then(e=>{this.tagList=e})},getCategory(){q.getCategory().then(e=>{this.categoryList=e})},saveArticle(){const e=this.$route.query.cid?"update":"add";if(!this.article.category_id)return this.$message.error("\u8BF7\u9009\u62E9\u6587\u7AE0\u5206\u7C7B");if(!this.article.fields.length)return this.$message.error("\u8BF7\u9009\u62E9\u6587\u7AE0\u6807\u7B7E");C[e](this.article).then(()=>{this.$message.success("\u4FDD\u5B58\u6210\u529F"),location.href="/admin/post-list"}).catch(t=>{this.$message.error("\u4FDD\u5B58\u5931\u8D25"),console.error(t)})},handleUploadImage(e,t,l){console.log(arguments),N.getUploadToken().then(_=>{const f=H().format("YYYY-MM-DD/HH-mm-ss");M(l[0],f,_).subscribe(null,null,u=>{t({url:`https://blog.cdn.thinkmoon.cn/${u.key}`})})})}}}),G=A($(d({},z),{__name:"editor",setup(e,{expose:t}){t();const l={fields:h};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}})),J={class:"editor-wrapper"},K=s("div",{class:"flex-1"},null,-1),Q={class:"editor-container"},R={class:"custom-options"},W={class:"flex-2 right"},X=s("span",{class:"title"},"\u6587\u7AE0\u5206\u7C7B",-1),Z={class:"content"},x=s("span",{class:"title"},"\u6587\u7AE0\u6807\u7B7E",-1),ee={class:"content"};function te(e,t,l,_,f,D){const u=c("el-input"),E=c("v-md-editor"),v=c("el-option"),y=c("el-select"),V=O;return o(),r("div",J,[K,s("div",Q,[i(u,{modelValue:e.article.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.article.title=a),class:"title-input"},null,8,["modelValue"]),i(E,{modelValue:e.article.text,"onUpdate:modelValue":t[1]||(t[1]=a=>e.article.text=a),mode:"edit",height:"560px","disabled-menus":[],onSave:e.saveArticle,onUploadImage:e.handleUploadImage},null,8,["modelValue","onSave","onUploadImage"]),s("div",R,[(o(!0),r(p,null,m(e.article.fields,(a,b)=>(o(),r(p,{key:a.name},[s("span",null,g(a.name),1),i(u,{modelValue:e.article.fields[b].value,"onUpdate:modelValue":F=>e.article.fields[b].value=F,type:"textarea",class:"input-with-select",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])],64))),128))])]),s("div",W,[s("section",null,[X,s("div",Z,[i(V,null,{default:n(()=>[i(y,{key:"category",modelValue:e.article.category_id,"onUpdate:modelValue":t[2]||(t[2]=a=>e.article.category_id=a)},{default:n(()=>[(o(!0),r(p,null,m(e.categoryList,a=>(o(),T(v,{key:a.mid,label:a.name,value:a.mid},{default:n(()=>[U(g(a.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),s("section",null,[x,s("div",ee,[i(V,null,{default:n(()=>[i(y,{key:"category",modelValue:e.article.selectedTag,"onUpdate:modelValue":t[3]||(t[3]=a=>e.article.selectedTag=a),filterable:"",multiple:""},{default:n(()=>[(o(!0),r(p,null,m(e.tagList,a=>(o(),T(v,{key:a.tid,label:a.name,value:a.tid},{default:n(()=>[U(g(a.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])])])])}var se=Y(G,[["render",te]]);export{se as default};
